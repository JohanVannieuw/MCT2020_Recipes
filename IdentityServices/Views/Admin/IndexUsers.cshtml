@model IEnumerable<IdentityServices.Models.User>
@{
    ViewData["Title"] = "IndexUsers";
}

<style>
    nav ul li {
        display: inline;
    }
</style>



<h1>IndexUsers</h1>

<nav>
    <ul>
        <li><a href="/admin/indexusers">All</a> | </li>
        @foreach (Role role in ViewBag.Roles)
        {
            <li> <a href="/admin/indexUsers?role=@role "> @role.Name</a> | </li>
        }
        <li><a href="/Identity/Account/Register">Create New User</a></li>
    </ul>
</nav>

<table class="table">
    <thead>
        <tr>
            <th></th>
            <th>
                @Html.DisplayNameFor(model => model.UserRoles)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.CardNumber)
            </th>
            @*<th>
                    @Html.DisplayNameFor(model => model.RSZ_number)
                </th>*@
            <th>
                @Html.DisplayNameFor(model => model.Id)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.UserName)
            </th>
            @*<th>
                    @Html.DisplayNameFor(model => model.NormalizedUserName)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.Email)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.NormalizedEmail)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.EmailConfirmed)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.PasswordHash)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.SecurityStamp)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.ConcurrencyStamp)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.PhoneNumber)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.PhoneNumberConfirmed)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.TwoFactorEnabled)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.LockoutEnd)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.LockoutEnabled)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.AccessFailedCount)
                </th>*@
            <th></th>
        </tr>
    </thead>
    <tbody>

    @foreach (var item in Model)
    {
        <tr><td>  
            @{var imagePath = "/images/" + item.UserName + ".jpg";
            }
            <img src="@imagePath"  onerror="this.style.display = 'none';return this.onerror=null;" height="75"   />
            </td>
            <td>
                @foreach (var role in item.UserRoles)
                {
                    @(role.Role.Name) <br />
                }

            </td>
            <td>
                @if (item.CardNumber != null)
                {
                    @Html.DisplayFor(modelItem => item.CardNumber)
                }
            </td>
            @*  <td>
                @Html.DisplayFor(modelItem => item.RSZ_number)
            </td>*@
            <td>
                @Html.DisplayFor(modelItem => item.Id)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.UserName)
            </td>
            @*<td>
                @Html.DisplayFor(modelItem => item.NormalizedUserName)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Email)
            </td>

            <td>
                @Html.DisplayFor(modelItem => item.PhoneNumber)
            </td>

*@
            <td>
                @Html.ActionLink("Edit", "Edit", new { id = item.Id }) |
                @Html.ActionLink("Details", "Details", new { id = item.Id }) |
                @Html.ActionLink("Delete", "DeleteUser", new { id = item.Id }, new {onclick = $"return confirm('Are you sure to delete {item.UserName} ?');" })|
                @Html.ActionLink("Add User To a Role", "AddRoleToUser", new { userId = item.Id })|
            </td>
        </tr>
    }
    </tbody>
</table>